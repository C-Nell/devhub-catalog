schemaVersion: 2.2.2
metadata:
  name: backstage-min
components:
  - name: tools
    container:
      image: registry.redhat.io/devspaces/udi-rhel9:3.23
      mountSources: true
      sourceMapping: /projects
      cpuLimit: "2"
      memoryLimit: "3Gi"
      env:
        - name: HOST
          value: "0.0.0.0"
        # - name: NODE_ENV
        #   value: "development"
        # - name: NODE_OPTIONS
        #   value: "--dns-result-order=ipv4first --max-old-space-size=2048"
      endpoints:
        - name: frontend
          targetPort: 3000
          exposure: public
          protocol: http
          secure: true
        - name: backend
          targetPort: 7007
          exposure: public
          protocol: http
          secure: true

commands:
  - id: startup
    exec:
      label: "ðŸš€ Run Startup Script"
      commandLine: cd /projects && node startup-script.js
      component: tools
      group:
        kind: build
        isDefault: true
