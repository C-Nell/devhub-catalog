---
result: CONDITIONAL
roleEntityRef: role:default/developer
pluginId: catalog
resourceType: catalog-entity
permissionMapping:
  - read
conditions:
  anyOf:
    # Show entities owned by user or their groups
    - rule: IS_ENTITY_OWNER
      resourceType: catalog-entity
      params:
        claims:
          - $ownerRefs  # ← Dynamically replaced with user + all their groups
    # Show any entity with visibility: public label
    - rule: HAS_ANNOTATION
      params:
        annotation: backstage.io/visibility
        value: public
    - rule: IS_ENTITY_KIND
      resourceType: catalog-entity
      params:
        kinds:
          - User
          - Group
          - Location
          - Resource
          - Domain
---
result: CONDITIONAL
roleEntityRef: role:default/developer
pluginId: catalog
resourceType: catalog-entity
permissionMapping:
  - update
  - delete
conditions:
  rule: IS_ENTITY_OWNER
  resourceType: catalog-entity
  params:
    claims:
      - $ownerRefs  # ← User can update/delete if they or their group owns it
